{"version":3,"sources":["angular-preload-image.js"],"names":["angular","module","factory","url","successCallback","errorCallback","element","Image","bind","this","attr","directive","preLoader","$timeout","firstStep","step","className","outdatedTry","timeout","attrs","limit","$el","Math","pow","img","next","remove","css","height","toggleClass","defaultSpinner","restrict","terminal","priority","link","scope","$element","ngSrc","spinner","defaultImage","after","$spinner","$set","complete","src","class","preloadBgImage","background-image","undefined","default"],"mappings":"CAAA,SAAWA,GACT,YAEAA,GAAQC,OAAO,4BAEfD,EAAQC,OAAO,yBAAyBC,QAAQ,YAAa,WAE3D,MAAO,UAAUC,EAAKC,EAAiBC,GACrCL,EAAQM,QAAQ,GAAIC,QACnBC,KAAK,OAAQ,WACZJ,EAAgBK,QACfD,KAAK,QAAS,WACfH,MACCK,KAAK,MAAOP,MAInBH,EAAQC,OAAO,yBAAyBU,UAAU,gBAAiB,YAAa,WAC9E,SAAUC,EAAWC,GACnB,GAAIC,GAAY,IACZC,EAAO,EACPC,EAAY,uBAEZC,EAAc,SAASC,EAASf,EAAKgB,EAAOC,EAAOC;AAGjDP,EAAYQ,KAAKC,IAAIR,EAAMK,EAAQ,KAAOF,GAI9CL,EACE,WACED,EAAUT,EAAK,SAAUqB,GACvBH,EAAII,OAAOC,SACXL,EAAIM,IAAI,SAAUH,EAAII,OAAS,MAC/Bf,EAAS,WACPQ,EAAIQ,YAAYb,IACf,MACF,WACDC,EAAsB,EAAVC,GAAeJ,EAAWX,EAAKgB,EAAOE,MAGtDH,IAIAY,EAAiB,wpIAErB,QACEC,SAAU,IACVC,UAAU,EACVC,SAAU,IACVC,KAAM,SAAUC,EAAOC,EAAUjB,GAC/B,GAAIhB,GAAMgB,EAAMkB,MACZjB,EAAQD,EAAMC,MACdkB,EAAUnB,EAAMoB,cAAgBT,CAMpC,IAJAM,EAASI,MAAMC,GAAUZ,YAAYb,GAErCG,EAAMuB,KAAK,MAAOvC,GAEdiC,EAAS,GAAGO,SAEd,MADAP,GAASP,YAAYb,GACrB,MAGF,IAAIyB,GAAWzC,EAAQM,QAAQ,GAAIC,QAASG,MAAQkC,IAAON,EAASO,QAAS7B,EAAY,YAEzFoB,GAASI,MAAMC,GAEfxB,EAAY,EAAGd,EAAKgB,EAAOC,GAAS,EAAGgB,QAM/CpC,EAAQC,OAAO,yBAAyBU,UAAU,kBAAmB,YAAa,WAChF,SAAUC,EAAWC,GAEnB,GAAII,GAAc,SAASC,EAASZ,EAASa,GAC3CN,EACE,WACED,EAAUO,EAAM2B,eAAgB,WAC9BxC,EAAQqB,KACNoB,mBAAoB,QAAU5B,EAAM2B,eAAiB,QAEtD,WACD7B,EAAsB,EAAVC,GAAe,IAAMZ,EAASa,MAG9CD,GAIJ,QACEa,SAAU,IACVG,KAAM,SAAUC,EAAO7B,EAASa,GAED6B,SAAzB7B,EAAM2B;AAGRX,EAAMc,QAAU9B,EAAMoB,cAAgB,6NAEtCjC,EAAQqB,KACNoB,mBAAoB,QAAUZ,EAAMc,QAAQ,OAG9ChC,EAAY,EAAGX,EAASa,UAOjCnB","file":"angular-preload-image.min.js","sourcesContent":["(function (angular) {\n  'use strict';\n\n  angular.module('angular-preload-image', []);\n\n  angular.module('angular-preload-image').factory('preLoader', function () {\n\n    return function (url, successCallback, errorCallback) {\n      angular.element(new Image())\n      .bind('load', function () {\n        successCallback(this);\n      }).bind('error', function () {\n        errorCallback();\n      }).attr('src', url);\n    };\n  });\n\n  angular.module('angular-preload-image').directive('preloadImage', ['preLoader', '$timeout',\n    function (preLoader, $timeout) {\n      var firstStep = 1000;\n      var step = 2;\n      var className = 'ng-preloader-loading';\n\n      var outdatedTry = function(timeout, url, attrs, limit, $el) {\n        // Math stuff...\n\n        if (firstStep * Math.pow(step, limit - 1) === timeout) {\n          return;\n        }\n\n        $timeout(\n          function() {\n            preLoader(url, function (img) {\n              $el.next().remove();\n              $el.css('height', img.height + 'px');\n              $timeout(function() {\n                $el.toggleClass(className);\n              }, 300);\n            }, function () {\n              outdatedTry(timeout * 2 || firstStep, url, attrs, $el);\n            });\n          },\n          timeout\n        );\n      };\n\n      var defaultSpinner = 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0nMTIwcHgnIGhlaWdodD0nMTIwcHgnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgdmlld0JveD0iMCAwIDEwMCAxMDAiIHByZXNlcnZlQXNwZWN0UmF0aW89InhNaWRZTWlkIiBjbGFzcz0idWlsLWRlZmF1bHQiPjxyZWN0IHg9IjAiIHk9IjAiIHdpZHRoPSIxMDAiIGhlaWdodD0iMTAwIiBmaWxsPSJub25lIiBjbGFzcz0iYmsiPjwvcmVjdD48cmVjdCAgeD0nNDguMjUnIHk9JzQ1JyB3aWR0aD0nMy41JyBoZWlnaHQ9JzEwJyByeD0nMi41JyByeT0nMi41JyBmaWxsPScjNGE0YTRhJyB0cmFuc2Zvcm09J3JvdGF0ZSgwIDUwIDUwKSB0cmFuc2xhdGUoMCAtMTUpJz4gIDxhbmltYXRlIGF0dHJpYnV0ZU5hbWU9J29wYWNpdHknIGZyb209JzEnIHRvPScwJyBkdXI9Jy41cycgYmVnaW49JzBzJyByZXBlYXRDb3VudD0naW5kZWZpbml0ZScvPjwvcmVjdD48cmVjdCAgeD0nNDguMjUnIHk9JzQ1JyB3aWR0aD0nMy41JyBoZWlnaHQ9JzEwJyByeD0nMi41JyByeT0nMi41JyBmaWxsPScjNGE0YTRhJyB0cmFuc2Zvcm09J3JvdGF0ZSgzMCA1MCA1MCkgdHJhbnNsYXRlKDAgLTE1KSc+ICA8YW5pbWF0ZSBhdHRyaWJ1dGVOYW1lPSdvcGFjaXR5JyBmcm9tPScxJyB0bz0nMCcgZHVyPScuNXMnIGJlZ2luPScwLjA0MTY2NjY2NjY2NjY2NjY2NHMnIHJlcGVhdENvdW50PSdpbmRlZmluaXRlJy8+PC9yZWN0PjxyZWN0ICB4PSc0OC4yNScgeT0nNDUnIHdpZHRoPSczLjUnIGhlaWdodD0nMTAnIHJ4PScyLjUnIHJ5PScyLjUnIGZpbGw9JyM0YTRhNGEnIHRyYW5zZm9ybT0ncm90YXRlKDYwIDUwIDUwKSB0cmFuc2xhdGUoMCAtMTUpJz4gIDxhbmltYXRlIGF0dHJpYnV0ZU5hbWU9J29wYWNpdHknIGZyb209JzEnIHRvPScwJyBkdXI9Jy41cycgYmVnaW49JzAuMDgzMzMzMzMzMzMzMzMzMzNzJyByZXBlYXRDb3VudD0naW5kZWZpbml0ZScvPjwvcmVjdD48cmVjdCAgeD0nNDguMjUnIHk9JzQ1JyB3aWR0aD0nMy41JyBoZWlnaHQ9JzEwJyByeD0nMi41JyByeT0nMi41JyBmaWxsPScjNGE0YTRhJyB0cmFuc2Zvcm09J3JvdGF0ZSg5MCA1MCA1MCkgdHJhbnNsYXRlKDAgLTE1KSc+ICA8YW5pbWF0ZSBhdHRyaWJ1dGVOYW1lPSdvcGFjaXR5JyBmcm9tPScxJyB0bz0nMCcgZHVyPScuNXMnIGJlZ2luPScwLjEyNXMnIHJlcGVhdENvdW50PSdpbmRlZmluaXRlJy8+PC9yZWN0PjxyZWN0ICB4PSc0OC4yNScgeT0nNDUnIHdpZHRoPSczLjUnIGhlaWdodD0nMTAnIHJ4PScyLjUnIHJ5PScyLjUnIGZpbGw9JyM0YTRhNGEnIHRyYW5zZm9ybT0ncm90YXRlKDEyMCA1MCA1MCkgdHJhbnNsYXRlKDAgLTE1KSc+ICA8YW5pbWF0ZSBhdHRyaWJ1dGVOYW1lPSdvcGFjaXR5JyBmcm9tPScxJyB0bz0nMCcgZHVyPScuNXMnIGJlZ2luPScwLjE2NjY2NjY2NjY2NjY2NjY2cycgcmVwZWF0Q291bnQ9J2luZGVmaW5pdGUnLz48L3JlY3Q+PHJlY3QgIHg9JzQ4LjI1JyB5PSc0NScgd2lkdGg9JzMuNScgaGVpZ2h0PScxMCcgcng9JzIuNScgcnk9JzIuNScgZmlsbD0nIzRhNGE0YScgdHJhbnNmb3JtPSdyb3RhdGUoMTUwIDUwIDUwKSB0cmFuc2xhdGUoMCAtMTUpJz4gIDxhbmltYXRlIGF0dHJpYnV0ZU5hbWU9J29wYWNpdHknIGZyb209JzEnIHRvPScwJyBkdXI9Jy41cycgYmVnaW49JzAuMjA4MzMzMzMzMzMzMzMzMzRzJyByZXBlYXRDb3VudD0naW5kZWZpbml0ZScvPjwvcmVjdD48cmVjdCAgeD0nNDguMjUnIHk9JzQ1JyB3aWR0aD0nMy41JyBoZWlnaHQ9JzEwJyByeD0nMi41JyByeT0nMi41JyBmaWxsPScjNGE0YTRhJyB0cmFuc2Zvcm09J3JvdGF0ZSgxODAgNTAgNTApIHRyYW5zbGF0ZSgwIC0xNSknPiAgPGFuaW1hdGUgYXR0cmlidXRlTmFtZT0nb3BhY2l0eScgZnJvbT0nMScgdG89JzAnIGR1cj0nLjVzJyBiZWdpbj0nMC4yNXMnIHJlcGVhdENvdW50PSdpbmRlZmluaXRlJy8+PC9yZWN0PjxyZWN0ICB4PSc0OC4yNScgeT0nNDUnIHdpZHRoPSczLjUnIGhlaWdodD0nMTAnIHJ4PScyLjUnIHJ5PScyLjUnIGZpbGw9JyM0YTRhNGEnIHRyYW5zZm9ybT0ncm90YXRlKDIxMCA1MCA1MCkgdHJhbnNsYXRlKDAgLTE1KSc+ICA8YW5pbWF0ZSBhdHRyaWJ1dGVOYW1lPSdvcGFjaXR5JyBmcm9tPScxJyB0bz0nMCcgZHVyPScuNXMnIGJlZ2luPScwLjI5MTY2NjY2NjY2NjY2NjdzJyByZXBlYXRDb3VudD0naW5kZWZpbml0ZScvPjwvcmVjdD48cmVjdCAgeD0nNDguMjUnIHk9JzQ1JyB3aWR0aD0nMy41JyBoZWlnaHQ9JzEwJyByeD0nMi41JyByeT0nMi41JyBmaWxsPScjNGE0YTRhJyB0cmFuc2Zvcm09J3JvdGF0ZSgyNDAgNTAgNTApIHRyYW5zbGF0ZSgwIC0xNSknPiAgPGFuaW1hdGUgYXR0cmlidXRlTmFtZT0nb3BhY2l0eScgZnJvbT0nMScgdG89JzAnIGR1cj0nLjVzJyBiZWdpbj0nMC4zMzMzMzMzMzMzMzMzMzMzcycgcmVwZWF0Q291bnQ9J2luZGVmaW5pdGUnLz48L3JlY3Q+PHJlY3QgIHg9JzQ4LjI1JyB5PSc0NScgd2lkdGg9JzMuNScgaGVpZ2h0PScxMCcgcng9JzIuNScgcnk9JzIuNScgZmlsbD0nIzRhNGE0YScgdHJhbnNmb3JtPSdyb3RhdGUoMjcwIDUwIDUwKSB0cmFuc2xhdGUoMCAtMTUpJz4gIDxhbmltYXRlIGF0dHJpYnV0ZU5hbWU9J29wYWNpdHknIGZyb209JzEnIHRvPScwJyBkdXI9Jy41cycgYmVnaW49JzAuMzc1cycgcmVwZWF0Q291bnQ9J2luZGVmaW5pdGUnLz48L3JlY3Q+PHJlY3QgIHg9JzQ4LjI1JyB5PSc0NScgd2lkdGg9JzMuNScgaGVpZ2h0PScxMCcgcng9JzIuNScgcnk9JzIuNScgZmlsbD0nIzRhNGE0YScgdHJhbnNmb3JtPSdyb3RhdGUoMzAwIDUwIDUwKSB0cmFuc2xhdGUoMCAtMTUpJz4gIDxhbmltYXRlIGF0dHJpYnV0ZU5hbWU9J29wYWNpdHknIGZyb209JzEnIHRvPScwJyBkdXI9Jy41cycgYmVnaW49JzAuNDE2NjY2NjY2NjY2NjY2N3MnIHJlcGVhdENvdW50PSdpbmRlZmluaXRlJy8+PC9yZWN0PjxyZWN0ICB4PSc0OC4yNScgeT0nNDUnIHdpZHRoPSczLjUnIGhlaWdodD0nMTAnIHJ4PScyLjUnIHJ5PScyLjUnIGZpbGw9JyM0YTRhNGEnIHRyYW5zZm9ybT0ncm90YXRlKDMzMCA1MCA1MCkgdHJhbnNsYXRlKDAgLTE1KSc+ICA8YW5pbWF0ZSBhdHRyaWJ1dGVOYW1lPSdvcGFjaXR5JyBmcm9tPScxJyB0bz0nMCcgZHVyPScuNXMnIGJlZ2luPScwLjQ1ODMzMzMzMzMzMzMzMzNzJyByZXBlYXRDb3VudD0naW5kZWZpbml0ZScvPjwvcmVjdD48L3N2Zz4=';\n\n      return {\n        restrict: 'A',\n        terminal: true,\n        priority: 100,\n        link: function (scope, $element, attrs) {\n          var url = attrs.ngSrc;\n          var limit = attrs.limit;\n          var spinner = attrs.defaultImage || defaultSpinner;\n\n          $element.after($spinner).toggleClass(className);\n\n          attrs.$set('src', url);\n\n          if ($element[0].complete) {\n            $element.toggleClass(className);\n            return;\n          }\n\n          var $spinner = angular.element(new Image()).attr( { 'src': spinner, 'class': className + '-spinner' });\n\n          $element.after($spinner);\n\n          outdatedTry(0, url, attrs, limit || 0, $element);\n        }\n      };\n    }\n  ]);\n\n  angular.module('angular-preload-image').directive('preloadBgImage', ['preLoader', '$timeout',\n    function (preLoader, $timeout) {\n\n      var outdatedTry = function(timeout, element, attrs) {\n        $timeout(\n          function() {\n            preLoader(attrs.preloadBgImage, function () {\n              element.css({\n                'background-image': 'url(\"' + attrs.preloadBgImage + '\")'\n              });\n            }, function () {\n              outdatedTry(timeout * 2 || 1000, element, attrs);\n            });\n          },\n          timeout\n        );\n      };\n\n      return {\n        restrict: 'A',\n        link: function (scope, element, attrs) {\n\n          if (attrs.preloadBgImage !== undefined) {\n\n            //Define default image\n            scope.default = attrs.defaultImage || 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAIAAACQd1PeAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH3wEWEygNWiLqlwAAABl0RVh0Q29tbWVudABDcmVhdGVkIHdpdGggR0lNUFeBDhcAAAAMSURBVAjXY/j//z8ABf4C/tzMWecAAAAASUVORK5CYII=';\n\n            element.css({\n              'background-image': 'url(\"' + scope.default+'\")'\n            });\n\n            outdatedTry(0, element, attrs);\n          }\n        }\n      };\n    }\n  ]);\n\n})(angular);"],"sourceRoot":"/source/"}